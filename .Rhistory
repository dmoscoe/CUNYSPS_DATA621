knitr::opts_chunk$set(echo = TRUE)
#import packages
library(tidyverse)
library(corrplot)
library(Matrix)
library(Hmisc)
#read data
dftest = read_csv('crime-evaluation-data_modified.csv')
dftrain = read_csv('crime-training-data_modified.csv')
hist.data.frame(dftrain)
par(mar = c(1,1,1,1))
rows = 4
fields = ncol(dftrain)-1
par(mfrow = c(rows, round(ncol(dftrain)/rows, 1)+1))
invisible(lapply(1:fields, function(i) boxplot(unlist(dftrain[,i]) ~ target, data = dftrain,main = colnames(dftrain)[i])))
cormtx = cor(dftrain,use = "pairwise")
corrplot(cormtx,method="color", type = 'upper',tl.pos = 'td')
corrplot(cormtx,method="number", type = 'lower', add = TRUE,number.digits = 1,tl.pos = 'lt')
#convert matrix to list for sorting
#https://stackoverflow.com/questions/33781147/r-converting-correlation-matrix-to-pairwise
df_corr_pw<-reshape2::melt( cbind(
V1=rownames(cormtx),
as.data.frame(cormtx))
)
df_corr_pw<-subset(df.corr.pw,value!=1)
